# OceanWave

## SetUp
First, you need to install ns3.
```
cd
mkdir workspace
cd workspace
wget http://www.nsnam.org/release/ns-allinone-3.24.tar.bz2
tar xjf ns-allinone-3.24.tar.bz2
```
[ns3 Tutorial-Getting Started](https://www.nsnam.org/docs/release/3.24/tutorial/html/getting-started.html#downloading-ns3)

Then, copy `ocean-3d-random-walk.h` and `ocean-3d-random-walk.cc` to ns3/src/mobility/model. Also replace ns3/src/mobility/wcsript with wscript, which is the registration file and will not affect other funcationalities.

Same for copying`ocean-propagation-model.h` and `ocean-propagation-model.cc` to ns3/src/propagation/model, and copying wscript to replace ns3/src/propagation/wsript.

`ocean.cc` is the main function. In my preference, I will put this file in scratch/ . Then run
```
./waf --run scratch/ocean
```
will show the result.


## Functionality
### MobilityModel

The transverse mobility model is based on `ns3::RandomWalk2dMobilityModel` with a little adjustment. The original mobility model range is reference to (0,0) point. For example, if the bound is (0,100,0,100), the node will range in this 100-100 square. But the new model range is reference to the position the nodes set. For example, if the node is set on (10,10), and the bound is (0,5,0,5), the node will hover in (10,15,10,15) square. 

**NOTE** : The upper, lower limit of this range and node position should always be positive.

The vertical height of mobility model will read from ocean wave height file which generated by matlab. Because both time and location are discrete value, to find a height in any time and any position, we need to use interpolation twice.

### PropagationModel

Temporary maritime propagation model is based on [Near Sea-Surface Mobile Radiowave Propagation at 5 GHz: Measurements and Modeling](https://www.radioeng.cz/fulltexts/2014/14_03_0824_0830.pdf).

New propagation model will add later.

### Calculate Communication Link Block Probability

The wave height follows normal distribution. The mean of this normal distribution is zero, because wave is superposition of sine waves of different frequencies and amplitudes. The variance is related to wind speed (or Phillips Spectrum which we use to generate ocean wave on matlab, wind speed and Phillips Spectrum act the same role here), so it is also known.

Then we can use law of sines and cosines to calculate the block probability. Annotation in file will show details.
